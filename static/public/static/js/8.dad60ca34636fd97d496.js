(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{206:function(e,t,r){var o=r(207);"string"==typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(18)(o,i);o.locals&&(e.exports=o.locals)},207:function(e,t,r){(t=e.exports=r(17)(!1)).push([e.i,".userSetting-7Q_7J{background:white;padding-top:20px;padding-bottom:20px}.userSetting-7Q_7J .ant-tabs .ant-tabs-left-bar .ant-tabs-tab{text-align:left}.userSetting-7Q_7J .ant-tabs .ant-tabs-left-bar .ant-tabs-tab.ant-tabs-tab-active{background:#e6f7ff}.userSetting-7Q_7J .ant-tabs .ant-tabs-left-content{padding:0 50px}\n",""]),t.locals={setting:"userSetting-7Q_7J"}},208:function(e,t,r){var o=r(209);"string"==typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(18)(o,i);o.locals&&(e.exports=o.locals)},209:function(e,t,r){(t=e.exports=r(17)(!1)).push([e.i,".baseSetting-3Gk1A h2{font-size:20px;margin-bottom:20px}.baseSetting-3Gk1A form{display:-webkit-box;display:flex}.baseSetting-3Gk1A form .form-left{width:300px;margin-right:100px}.baseSetting-3Gk1A form .form-right{-webkit-box-flex:1;flex:1}\n",""]),t.locals={baseSetting:"baseSetting-3Gk1A"}},220:function(e,t,r){"use strict";r.r(t);var o=r(30),i=r.n(o),a=r(0),n=r.n(a),s=r(1),p=r(13),c=r(206),l=r.n(c),d=r(11),h=r(208),m=r.n(h),g=r(33),b=r(41),u=r(40),f=r(43);function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class C extends a.PureComponent{constructor(...e){super(...e),i()(this,"state",{error:!1}),i()(this,"handleUploaded",e=>{const{onChange:t}=this.props;t&&t(`http://${e.key}`)})}componentWillReceiveProps(e){const t=e["data-__field"].errors;this.setState({error:!(!t||!t.length)})}render(){const{value:e}=this.props,{error:t}=this.state,r=t?{boxShadow:"red 0px 0px 6px 1px"}:{};return n.a.createElement(u.a,{onUploaded:this.handleUploaded,uploadDir:"images/avatar",crop:{x:0,y:0,aspect:1,width:10,height:10}},n.a.createElement("div",{style:x({width:"100px",height:"100px",borderRadius:"50%"},r)},n.a.createElement(f.a,{src:e||""})))}}var w=C;class R extends a.Component{constructor(e){super(e),i()(this,"formInited",!1),i()(this,"initFormFields",e=>{const{setFieldsValue:t}=this.props.form;e&&!this.formInited&&(t({email:e.email,nickname:e.nickname,avatar:e.avatar}),this.formInited=!0)}),i()(this,"saveBaseInfo",()=>{const{validateFields:e}=this.props.form;e(async(e,t)=>{if(e)return;const{status:r,user:o,message:i}=await Object(g.i)(t.nickname,t.avatar);"success"===r?(this.props.updateUserInfo(o),d.message.success("更新成功")):d.message.error(i)})})}componentDidMount(){const{userInfo:e}=this.props;this.initFormFields(e)}componentWillReceiveProps(e){this.initFormFields(e.userInfo)}render(){const{getFieldDecorator:e}=this.props.form;return n.a.createElement("div",{className:m.a.baseSetting},n.a.createElement("h2",null,"基本设置"),n.a.createElement(d.Form,null,n.a.createElement("div",{className:"form-left"},n.a.createElement(d.Form.Item,{label:"邮箱"},e("email",{})(n.a.createElement(d.Input,{disabled:!0}))),n.a.createElement(d.Form.Item,{label:"昵称"},e("nickname",{rules:[{required:!0,message:"昵称不能为空"}]})(n.a.createElement(d.Input,null))),n.a.createElement(d.Form.Item,null,n.a.createElement(d.Button,{type:"primary",onClick:this.saveBaseInfo},"保存基本信息"))),n.a.createElement("div",{className:"form-right"},n.a.createElement(d.Form.Item,{label:"头像"},e("avatar",{rules:[{required:!0,message:"请上传头像"}]})(n.a.createElement(w,null))))))}}var y=Object(p.b)((function(e){return{userInfo:e.common.userInfo}}),(function(e){return{updateUserInfo:t=>{e(Object(b.b)(t))}}}))(d.Form.create()(R)),I=r(31);class v extends a.Component{componentDidMount(){Object(I.f)(10,1)}render(){return n.a.createElement("div",null,"/")}}var k=v;class E extends a.Component{constructor(e){super(e),i()(this,"state",{activeKey:"1"}),i()(this,"handleTabsChange",e=>{this.setState({activeKey:e})}),this.props.login||this.props.history.replace("/home")}render(){const{activeKey:e}=this.state;return n.a.createElement("div",{className:l.a.setting},n.a.createElement(d.Tabs,{activeKey:e,tabPosition:"left",tabBarStyle:{width:"224px"},onChange:this.handleTabsChange},n.a.createElement(d.Tabs.TabPane,{tab:"基本设置",key:"1"},n.a.createElement(y,null)),n.a.createElement(d.Tabs.TabPane,{tab:"文章设置",key:"2"},n.a.createElement(k,null))))}}t.default=Object(s.withRouter)(Object(p.b)((function(e){return{login:e.common.login}}))(E))},37:function(e,t,r){var o=r(38);"string"==typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(18)(o,i);o.locals&&(e.exports=o.locals)},38:function(e,t,r){(t=e.exports=r(17)(!1)).push([e.i,".ReactCrop{position:relative;display:inline-block;cursor:crosshair;overflow:hidden;max-width:100%;background-color:#000}.ReactCrop:focus{outline:none}.ReactCrop--disabled,.ReactCrop--locked{cursor:inherit}.ReactCrop__image{display:block;max-width:100%;max-height:-webkit-fill-available;max-height:-moz-available;max-height:fill-available}.ReactCrop--crop-invisible .ReactCrop__image{opacity:0.5}.ReactCrop__crop-selection{position:absolute;top:0;left:0;-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);box-sizing:border-box;cursor:move;box-shadow:0 0 0 9999em rgba(0,0,0,0.5);border:1px solid;border-image-source:url(\"data:image/gif;base64,R0lGODlhCgAKAJECAAAAAP///////wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI5RDc5MTFDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI5RDc5MTBDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQoAAgAsAAAAAAoACgAAAhWEERkn7W3ei7KlagMWF/dKgYeyGAUAIfkEBQoAAgAsAAAAAAoACgAAAg+UYwLJ7RnQm7QmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYgLJHdiinNSAVfOEKoUCACH5BAUKAAIALAAAAAAKAAoAAAIRVISAdusPo3RAzYtjaMIaUQAAIfkEBQoAAgAsAAAAAAoACgAAAg+MDiem7Q8bSLFaG5il6xQAIfkEBQoAAgAsAAAAAAoACgAAAg+UYRLJ7QnQm7SmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYBLJDdiinNSEVfOEKoECACH5BAUKAAIALAAAAAAKAAoAAAIRFISBdusPo3RBzYsjaMIaUQAAOw==\");border-image-slice:1;border-image-repeat:repeat}.ReactCrop--disabled .ReactCrop__crop-selection{cursor:inherit}.ReactCrop__drag-handle{position:absolute;width:9px;height:9px;background-color:rgba(0,0,0,0.2);border:1px solid rgba(255,255,255,0.7);box-sizing:border-box;outline:1px solid transparent}.ReactCrop .ord-nw{top:0;left:0;margin-top:-5px;margin-left:-5px;cursor:nw-resize}.ReactCrop .ord-n{top:0;left:50%;margin-top:-5px;margin-left:-5px;cursor:n-resize}.ReactCrop .ord-ne{top:0;right:0;margin-top:-5px;margin-right:-5px;cursor:ne-resize}.ReactCrop .ord-e{top:50%;right:0;margin-top:-5px;margin-right:-5px;cursor:e-resize}.ReactCrop .ord-se{bottom:0;right:0;margin-bottom:-5px;margin-right:-5px;cursor:se-resize}.ReactCrop .ord-s{bottom:0;left:50%;margin-bottom:-5px;margin-left:-5px;cursor:s-resize}.ReactCrop .ord-sw{bottom:0;left:0;margin-bottom:-5px;margin-left:-5px;cursor:sw-resize}.ReactCrop .ord-w{top:50%;left:0;margin-top:-5px;margin-left:-5px;cursor:w-resize}.ReactCrop__disabled .ReactCrop__drag-handle{cursor:inherit}.ReactCrop__drag-bar{position:absolute}.ReactCrop__drag-bar.ord-n{top:0;left:0;width:100%;height:6px;margin-top:-3px}.ReactCrop__drag-bar.ord-e{right:0;top:0;width:6px;height:100%;margin-right:-3px}.ReactCrop__drag-bar.ord-s{bottom:0;left:0;width:100%;height:6px;margin-bottom:-3px}.ReactCrop__drag-bar.ord-w{top:0;left:0;width:6px;height:100%;margin-left:-3px}.ReactCrop--new-crop .ReactCrop__drag-bar,.ReactCrop--new-crop .ReactCrop__drag-handle,.ReactCrop--fixed-aspect .ReactCrop__drag-bar{display:none}.ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-n,.ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-e,.ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-s,.ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-w{display:none}@media (max-width: 768px), (pointer: coarse){.ReactCrop__drag-handle{width:17px;height:17px}.ReactCrop .ord-nw{margin-top:-9px;margin-left:-9px}.ReactCrop .ord-n{margin-top:-9px;margin-left:-9px}.ReactCrop .ord-ne{margin-top:-9px;margin-right:-9px}.ReactCrop .ord-e{margin-top:-9px;margin-right:-9px}.ReactCrop .ord-se{margin-bottom:-9px;margin-right:-9px}.ReactCrop .ord-s{margin-bottom:-9px;margin-left:-9px}.ReactCrop .ord-sw{margin-bottom:-9px;margin-left:-9px}.ReactCrop .ord-w{margin-top:-9px;margin-left:-9px}.ReactCrop__drag-bar.ord-n{height:14px;margin-top:-7px}.ReactCrop__drag-bar.ord-e{width:14px;margin-right:-7px}.ReactCrop__drag-bar.ord-s{height:14px;margin-bottom:-7px}.ReactCrop__drag-bar.ord-w{width:14px;margin-left:-7px}}.imageCropper-38CPD{display:inline-block;font-size:0;line-height:0}.imageCropper-38CPD.active::before{content:'';position:fixed;top:0;bottom:0;left:0;right:0;z-index:9998;background:rgba(255,255,255,0.5)}.imageCropper-38CPD .selector{position:relative;display:inline-block;cursor:pointer}.imageCropper-38CPD .selector input{position:absolute;top:0;left:0;opacity:0;z-index:1;width:100%;height:100%;display:block;cursor:pointer}.imageCropper-38CPD .selector .default-select{width:50px;height:50px;border-radius:3px;border:1px dashed #333333;display:block;position:relative;cursor:pointer}.imageCropper-38CPD .selector .default-select::before{content:'';position:absolute;width:2px;margin-left:-1px;height:50%;background-color:#333333;left:50%;top:25%;z-index:0;border-radius:1px}.imageCropper-38CPD .selector .default-select::after{content:'';position:absolute;height:2px;margin-top:-1px;width:50%;background-color:#333333;top:50%;left:25%;z-index:0;border-radius:1px}.crop-wrapper{position:fixed;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);box-shadow:0px 5px 16px 0px rgba(0,0,0,0.95);z-index:9999}.crop-wrapper .ReactCrop{display:block}.crop-wrapper .tools{position:absolute;bottom:0;width:100%;padding:10px;left:0;color:white;background:-webkit-gradient(linear, left top, left bottom, color-stop(0, rgba(0,0,0,0)), to(rgba(0,0,0,0.5)));background:linear-gradient(to bottom, rgba(0,0,0,0) 0, rgba(0,0,0,0.5) 100%);display:-webkit-box;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;flex-direction:row-reverse}.crop-wrapper .tools button{cursor:pointer;border:1px dashed #fff;margin:0 3px;font-size:12px;line-height:20px}.crop-wrapper .tools button:hover{background:#fff;color:#999}\n",""]),t.locals={cropper:"imageCropper-38CPD"}},40:function(e,t,r){"use strict";var o=r(30),i=r.n(o),a=r(0),n=r.n(a),s=r(14),p=r.n(s),c=r(49),l=r.n(c),d=r(37),h=r.n(d);class m extends a.PureComponent{constructor(e){super(e),i()(this,"state",{originalSrc:"",crop:{x:0,y:0}}),i()(this,"originalFileName",""),i()(this,"image",void 0),i()(this,"pixelCrop",void 0),i()(this,"inputRef",n.a.createRef()),i()(this,"handleFileInput",e=>{const t=e.target.files&&e.target.files[0];if(t)if(this.originalFileName=t.name,"image/gif"===t.type){const{onConfirm:e}=this.props;e&&e(t)}else{const e=new FileReader;e.readAsDataURL(t),e.onload=()=>{this.setState({originalSrc:e.result})}}}),i()(this,"handleCropChange",(e,t)=>{this.setState({crop:e}),this.pixelCrop=t}),i()(this,"handleImageloaded",(e,t)=>{this.image=e,this.pixelCrop=t}),i()(this,"getCroppedImg",(e,t,r)=>{const o=document.createElement("canvas");o.width=t.width,o.height=t.height;const i=o.getContext("2d");return i&&i.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),new Promise((e,t)=>{o.toBlob(t=>{t.name=r,e(t)},"image/jpeg")})}),i()(this,"confirm",async()=>{const{onConfirm:e}=this.props;if(this.image&&this.pixelCrop&&e){this.pixelCrop.width=this.pixelCrop.width||this.image.naturalWidth,this.pixelCrop.height=this.pixelCrop.height||this.image.naturalHeight,e(await this.getCroppedImg(this.image,this.pixelCrop,this.originalFileName))}this.cancel()}),i()(this,"cancel",()=>{this.setState({originalSrc:""}),this.inputRef.current&&(this.inputRef.current.value="")}),e.crop&&(this.state.crop=e.crop)}render(){const{originalSrc:e,crop:t}=this.state,{children:r}=this.props;let o;return e&&(o=n.a.createElement("div",{className:"crop-wrapper"},n.a.createElement(l.a,{src:e,crop:t,onImageLoaded:this.handleImageloaded,onChange:this.handleCropChange}),n.a.createElement("div",{className:"tools"},n.a.createElement("button",{type:"button",onClick:this.confirm},"确定"),n.a.createElement("button",{type:"button",onClick:this.cancel},"取消")))),n.a.createElement("div",{className:`${h.a.cropper} ${e?"active":""}`},n.a.createElement("div",{className:"selector"},r||n.a.createElement("span",{className:"default-select"}),n.a.createElement("input",{ref:this.inputRef,type:"file",onInput:this.handleFileInput,accept:"image/*"})),p.a.createPortal(o,document.body))}}var g=m,b=r(50),u=r.n(b),f=r(33),A=r(11);class x extends a.PureComponent{constructor(e){super(e),i()(this,"cos",void 0),i()(this,"file",void 0),i()(this,"credential",{TmpSecretId:"",TmpSecretKey:"",XCosSecurityToken:"",ExpiredTime:0}),i()(this,"region",""),i()(this,"bucket",""),i()(this,"directory",""),i()(this,"domain",""),i()(this,"upload",()=>{const{onUploaded:e,uploadDir:t,bucketType:r}=this.props;if("user"!==r&&!t)return console.warn("上传目录未指定");const o=this.directory||t,i=`${Date.now()}_${this.file.name}`;this.cos.putObject({Bucket:this.bucket,Region:this.region,Key:`${o}/${i}`,Body:this.file,onProgress(e){const{loaded:t,total:r,speed:o,percent:i}=e;console.log("percent ::",i)}},(t,r)=>{if(t)return console.log(t);const{Location:o}=r;e&&e({key:o,directory:this.directory,filename:i,originFilename:this.file.name,domain:this.domain})})}),i()(this,"handleConfirm",e=>{this.file=e,this.upload()}),this.cos=new u.a({getAuthorization:async(e,t)=>{t(await this.getCredential())}}),this.getCredential()}async getCredential(){const{bucketType:e}=this.props;if(this.credential.ExpiredTime<Date.now()){const{status:t,message:r,data:o}=await Object(f.f)(e);return"success"===t?(this.credential={TmpSecretId:o.credentials&&o.credentials.tmpSecretId,TmpSecretKey:o.credentials&&o.credentials.tmpSecretKey,XCosSecurityToken:o.credentials&&o.credentials.sessionToken,ExpiredTime:1e3*o.expiredTime},this.region=o.region,this.bucket=o.bucket,this.directory=o.directory,this.domain=o.domain,this.credential):(A.message.error(r),{})}return this.credential}render(){const{children:e,crop:t}=this.props;return n.a.createElement(g,{onConfirm:this.handleConfirm,crop:t},e)}}t.a=x}}]);