(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{179:function(t,e,r){var a=r(180);"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};r(18)(a,i);a.locals&&(t.exports=a.locals)},180:function(t,e,r){(e=t.exports=r(17)(!1)).i(r(181),""),e.i(r(182),""),e.push([t.i,".markdownEditor-1PpA2{height:100vh;position:relative}.markdownEditor-1PpA2 .article-title{height:60px;border-bottom:1px solid #ccc;display:-webkit-box;display:flex;-webkit-box-align:center;align-items:center;padding:0 15px;-webkit-box-pack:justify;justify-content:space-between}.markdownEditor-1PpA2 .article-title input{height:50px;font-size:24px;font-weight:bold;width:60%;display:block}.markdownEditor-1PpA2 .article-title .update-time{color:#ccc;margin-right:10px;vertical-align:bottom;font-size:12px}.markdownEditor-1PpA2 .editor-content{position:absolute;width:100%;top:60px;bottom:0;display:-webkit-box;display:flex}.markdownEditor-1PpA2 .editor-content .codemirror-wrapper{width:40%;position:relative}.markdownEditor-1PpA2 .editor-content .codemirror-wrapper .react-codemirror2{height:100%}.markdownEditor-1PpA2 .editor-content .codemirror-wrapper .react-codemirror2 .CodeMirror{height:100%}.markdownEditor-1PpA2 .editor-content .codemirror-wrapper .insert{position:absolute;bottom:20px;right:20px}.markdownEditor-1PpA2 .editor-content .markdown-parser{-webkit-box-flex:1;flex:1;padding:0 15px;overflow-y:auto}\n",""]),e.locals={editor:"markdownEditor-1PpA2"}},215:function(t,e,r){"use strict";r.r(e);var a=r(30),i=r.n(a),o=r(0),n=r.n(o),s=r(13),c=r(1),d=r(99),u=r(11),l=r(66),p=r.n(l),m=r(179),h=r.n(m),g=(r(74),r(183),r(33)),f=r(12),b=r(28),w=r.n(b);class v extends o.Component{constructor(t){super(t),i()(this,"state",{title:"",source:"",articleId:"",saving:!1,updateTime:""}),i()(this,"editor",void 0),i()(this,"handleTitleInput",t=>{this.setState({title:t.target.value})}),i()(this,"saveOrCreate",async t=>{const{title:e,articleId:r,source:a}=this.state;if(this.saving=!0,r){const{status:t,message:i,data:o}=await Object(g.b)(r,e,a);"error"===t?u.message.error(i):this.setState({updateTime:o.updateTime})}else{const{status:t,data:r,message:i}=await Object(g.a)(e,a);"success"===t?(this.setState({articleId:r.id,updateTime:r.updateTime}),Object(f.d)(r.id)):u.message.error(i)}this.saving=!1}),i()(this,"insertImage",t=>{const e=this.editor.getDoc(),r=e.getCursor();e.replaceRange("![react](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570718743454&di=9fa0e52ae247791fd04786169194b387&imgtype=0&src=http%3A%2F%2Fimg.aso.aizhan.com%2Ficon%2F8a%2F39%2Fa9%2F8a39a9da41c1585e472ed93623bcfa6d.jpg)",r)}),this.props.login?(this.state.articleId=Object(f.a)(),this.getArticleDetail()):this.props.history.goBack()}get saving(){return this.state.saving}set saving(t){this.setState({saving:t})}async getArticleDetail(){const{articleId:t}=this.state;if(!t)return;const{status:e,message:r,data:a}=await Object(g.c)(t);"success"===e?this.setState({title:a.title,source:a.markdown,updateTime:a.updateTime}):u.message.error(r)}render(){const{title:t,source:e,articleId:r,saving:a,updateTime:i}=this.state;return n.a.createElement("div",{className:h.a.editor},n.a.createElement("div",{className:"article-title"},n.a.createElement("input",{value:t,type:"text",placeholder:"输入文章标题...",onChange:this.handleTitleInput}),n.a.createElement("div",{className:"tools"},i&&n.a.createElement("span",{className:"update-time"},"保存时间：",w()(i).format("YYYY年MM月DD日 HH:mm:ss")),n.a.createElement(u.Button,{htmlType:"button",type:"primary",loading:a,ghost:!0,onClick:this.saveOrCreate},r?"保存":"新建"))),n.a.createElement("div",{className:"editor-content"},n.a.createElement("div",{className:"codemirror-wrapper"},n.a.createElement(d.Controlled,{editorDidMount:t=>this.editor=t,value:e,options:{mode:"markdown",theme:"monokai",lineNumbers:!0,lineWrapping:!0},onBeforeChange:(t,e,r)=>{this.setState({source:r})}}),n.a.createElement(u.Button,{className:"insert",type:"primary",onClick:this.insertImage},"图片")),n.a.createElement(p.a,{className:"markdown-parser markdown-style",source:e,sourcePos:!1})))}}e.default=Object(c.withRouter)(Object(s.b)((function(t){return{login:t.common.login}}))(v))},31:function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return o})),r.d(e,"d",(function(){return n})),r.d(e,"e",(function(){return s})),r.d(e,"a",(function(){return c}));var a=r(32);function i(t,e){return Object(a.a)({url:"/article",method:"post",data:{title:t,markdown:e}})}function o(t,e,r){return Object(a.a)({url:`/article/${t}`,method:"put",data:{title:e,markdown:r}})}function n(t,e){return Object(a.a)({url:"/allArticle",params:{pageSize:t,page:e}})}function s(t){return Object(a.a)({url:`/article/${t}`})}function c(t,e){return Object(a.a)({url:"/articleVisit",method:"post",data:{articleId:t,userId:e}})}},32:function(t,e,r){"use strict";var a=r(41),i=r.n(a),o=r(3),n=r(11),s=r(12),c=r(42);const d=i.a.create({baseURL:o.a.HTTP_BASE_URL,validateStatus:t=>t>=200&&t<500});e.a=async function(t){const e=Object(s.b)(),r=e?Object(c.merge)({headers:{Authorization:`Bearer ${e}`}},t):t,{data:a,status:i}=await d(r);if(401===i){const t="401";n.notification.error({message:"您未登录或者登录已失效",description:"点我重新登录",duration:null,style:{cursor:"pointer"},key:t,onClick(){location.replace("#/login"),n.notification.close(t)}})}return Promise.resolve(a)}},33:function(t,e,r){"use strict";r.d(e,"g",(function(){return o})),r.d(e,"d",(function(){return n})),r.d(e,"i",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"h",(function(){return d})),r.d(e,"f",(function(){return u}));var a=r(32),i=r(31);function o(t,e){return Object(a.a)({url:"/login",method:"post",data:{email:t,password:e}})}function n(){return Object(a.a)({url:"/user"})}function s(t,e){return Object(a.a)({url:"/user",method:"put",data:{avatar:e,nickname:t}})}function c(t){return Object(a.a)({url:"/mailVerifyCode",method:"post",data:{email:t}})}function d(t,e,r){return Object(a.a)({url:"/register",method:"post",data:{email:t,password:e,verifyCode:r}})}function u(t){return Object(a.a)({url:"/qcloud/uploadCredential",params:{type:t}})}r.d(e,"a",(function(){return i.b})),r.d(e,"b",(function(){return i.c})),r.d(e,"c",(function(){return i.e}))}}]);