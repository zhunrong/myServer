(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{182:function(t,e,r){var n=r(183);"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};r(18)(n,a);n.locals&&(t.exports=n.locals)},183:function(t,e,r){(e=t.exports=r(17)(!1)).i(r(184),""),e.i(r(185),""),e.push([t.i,".markdownEditor-1PpA2 {\n  height: 100vh;\n  position: relative; }\n  .markdownEditor-1PpA2 .article-title {\n    height: 60px;\n    border-bottom: 1px solid #ccc;\n    display: flex;\n    align-items: center;\n    padding: 0 15px;\n    justify-content: space-between; }\n    .markdownEditor-1PpA2 .article-title input {\n      height: 50px;\n      font-size: 24px;\n      font-weight: bold;\n      width: 60%;\n      display: block; }\n    .markdownEditor-1PpA2 .article-title .update-time {\n      color: #ccc;\n      margin-right: 10px;\n      vertical-align: bottom;\n      font-size: 12px; }\n  .markdownEditor-1PpA2 .editor-content {\n    position: absolute;\n    width: 100%;\n    top: 60px;\n    bottom: 0;\n    display: flex; }\n    .markdownEditor-1PpA2 .editor-content .codemirror-wrapper {\n      width: 40%;\n      position: relative; }\n      .markdownEditor-1PpA2 .editor-content .codemirror-wrapper .react-codemirror2 {\n        height: 100%; }\n        .markdownEditor-1PpA2 .editor-content .codemirror-wrapper .react-codemirror2 .CodeMirror {\n          height: 100%; }\n      .markdownEditor-1PpA2 .editor-content .codemirror-wrapper .insert {\n        position: absolute;\n        bottom: 20px;\n        right: 20px; }\n    .markdownEditor-1PpA2 .editor-content .markdown-parser {\n      flex: 1;\n      padding: 0 15px;\n      overflow-y: auto; }\n",""]),e.locals={editor:"markdownEditor-1PpA2"}},218:function(t,e,r){"use strict";r.r(e);var n=r(32),a=r.n(n),i=r(0),o=r.n(i),s=r(12),c=r(1),d=r(103),u=r(10),l=r(70),p=r.n(l),m=r(182),h=r.n(m),g=(r(78),r(186),r(35)),f=r(11),b=r(30),w=r.n(b);e.default=Object(c.withRouter)(Object(s.b)(function(t){return{login:t.common.login}})(class extends i.Component{constructor(t){super(t),a()(this,"state",{title:"",source:"",articleId:"",saving:!1,updateTime:""}),a()(this,"editor",void 0),a()(this,"handleTitleInput",t=>{this.setState({title:t.target.value})}),a()(this,"saveOrCreate",async t=>{const{title:e,articleId:r,source:n}=this.state;if(this.saving=!0,r){const{status:t,message:a,data:i}=await Object(g.b)(r,e,n);"error"===t?u.message.error(a):this.setState({updateTime:i.updateTime})}else{const{status:t,data:r,message:a}=await Object(g.a)(e,n);"success"===t?(this.setState({articleId:r.id,updateTime:r.updateTime}),Object(f.d)(r.id)):u.message.error(a)}this.saving=!1}),a()(this,"insertImage",t=>{const e=this.editor.getDoc(),r=e.getCursor();e.replaceRange("![react](https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1570718743454&di=9fa0e52ae247791fd04786169194b387&imgtype=0&src=http%3A%2F%2Fimg.aso.aizhan.com%2Ficon%2F8a%2F39%2Fa9%2F8a39a9da41c1585e472ed93623bcfa6d.jpg)",r)}),this.props.login?(this.state.articleId=Object(f.a)(),this.getArticleDetail()):this.props.history.goBack()}get saving(){return this.state.saving}set saving(t){this.setState({saving:t})}async getArticleDetail(){const{articleId:t}=this.state;if(!t)return;const{status:e,message:r,data:n}=await Object(g.c)(t);"success"===e?this.setState({title:n.title,source:n.markdown,updateTime:n.updateTime}):u.message.error(r)}render(){const{title:t,source:e,articleId:r,saving:n,updateTime:a}=this.state;return o.a.createElement("div",{className:h.a.editor},o.a.createElement("div",{className:"article-title"},o.a.createElement("input",{value:t,type:"text",placeholder:"输入文章标题...",onChange:this.handleTitleInput}),o.a.createElement("div",{className:"tools"},a&&o.a.createElement("span",{className:"update-time"},"保存时间：",w()(a).format("YYYY年MM月DD日 HH:mm:ss")),o.a.createElement(u.Button,{htmlType:"button",type:"primary",loading:n,ghost:!0,onClick:this.saveOrCreate},r?"保存":"新建"))),o.a.createElement("div",{className:"editor-content"},o.a.createElement("div",{className:"codemirror-wrapper"},o.a.createElement(d.Controlled,{editorDidMount:t=>this.editor=t,value:e,options:{mode:"markdown",theme:"monokai",lineNumbers:!0,lineWrapping:!0},onBeforeChange:(t,e,r)=>{this.setState({source:r})}}),o.a.createElement(u.Button,{className:"insert",type:"primary",onClick:this.insertImage},"图片")),o.a.createElement(p.a,{className:"markdown-parser markdown-style",source:e,sourcePos:!1})))}}))},33:function(t,e,r){"use strict";r.d(e,"b",function(){return a}),r.d(e,"c",function(){return i}),r.d(e,"d",function(){return o}),r.d(e,"e",function(){return s}),r.d(e,"a",function(){return c});var n=r(34);function a(t,e){return Object(n.a)({url:"/article",method:"post",data:{title:t,markdown:e}})}function i(t,e,r){return Object(n.a)({url:`/article/${t}`,method:"put",data:{title:e,markdown:r}})}function o(t,e){return Object(n.a)({url:"/allArticle",params:{pageSize:t,page:e}})}function s(t){return Object(n.a)({url:`/article/${t}`})}function c(t,e){return Object(n.a)({url:"/articleVisit",method:"post",data:{articleId:t,userId:e}})}},34:function(t,e,r){"use strict";var n=r(43),a=r.n(n),i=r(3),o=r(10),s=r(11),c=r(44);const d=a.a.create({baseURL:i.a.HTTP_BASE_URL,validateStatus:t=>t>=200&&t<500});e.a=async function(t){const e=Object(s.b)(),r=e?Object(c.merge)({headers:{Authorization:`Bearer ${e}`}},t):t,{data:n,status:a}=await d(r);if(401===a){const t="401";o.notification.error({message:"您未登录或者登录已失效",description:"点我重新登录",duration:null,style:{cursor:"pointer"},key:t,onClick(){location.replace("#/login"),o.notification.close(t)}})}return Promise.resolve(n)}},35:function(t,e,r){"use strict";r.d(e,"g",function(){return i}),r.d(e,"d",function(){return o}),r.d(e,"i",function(){return s}),r.d(e,"e",function(){return c}),r.d(e,"h",function(){return d}),r.d(e,"f",function(){return u});var n=r(34),a=r(33);function i(t,e){return Object(n.a)({url:"/login",method:"post",data:{email:t,password:e}})}function o(){return Object(n.a)({url:"/user"})}function s(t,e){return Object(n.a)({url:"/user",method:"put",data:{avatar:e,nickname:t}})}function c(t){return Object(n.a)({url:"/mailVerifyCode",method:"post",data:{email:t}})}function d(t,e,r){return Object(n.a)({url:"/register",method:"post",data:{email:t,password:e,verifyCode:r}})}function u(t){return Object(n.a)({url:"/qcloud/uploadCredential",params:{type:t}})}r.d(e,"a",function(){return a.b}),r.d(e,"b",function(){return a.c}),r.d(e,"c",function(){return a.e})}}]);