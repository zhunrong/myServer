(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{215:function(e,t,n){var r=n(216);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(18)(r,i);r.locals&&(e.exports=r.locals)},216:function(e,t,n){(t=e.exports=n(17)(!1)).push([e.i,".pictures-x3P3v {\n  padding-bottom: 24px; }\n  .pictures-x3P3v .btn {\n    font-size: 40px;\n    color: #333;\n    display: flex;\n    width: 100px;\n    height: 100px;\n    line-height: 30px;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    border: 1px solid #999; }\n    .pictures-x3P3v .btn span {\n      font-size: 18px; }\n  .pictures-x3P3v .waterfall-layout {\n    position: relative; }\n    .pictures-x3P3v .waterfall-layout .waterfall-item {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 244px;\n      float: left;\n      box-sizing: border-box;\n      padding: 10px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      background: white;\n      box-shadow: 0 0 8px #ccc; }\n      .pictures-x3P3v .waterfall-layout .waterfall-item img {\n        width: 100%; }\n",""]),t.locals={className:"pictures-x3P3v"}},226:function(e,t,n){"use strict";n.r(t);var r=n(63),i=n.n(r),o=n(32),a=n.n(o),s=n(0),p=n.n(s),c=n(47),l=n(10),d=n(34);var h=n(215),g=n.n(h);let m=[],u=[-10,-10,-10,-10];function A(e){const{children:t}=e,[n,r]=Object(s.useState)(0);return Object(s.useEffect)(()=>{console.log("e",u);const e=Math.max(...u,0);e!==n&&r(e)}),p.a.createElement("div",{className:"waterfall-layout",style:{height:n}},t)}function x(e){const{children:t,width:n,height:r,visible:o}=e,[a,c]=Object(s.useState)({transform:"translate3d(0,0,0)",opacity:0,width:n,height:r});if(o&&0===a.opacity){m.push([n,r]);const e=Math.min(...u),t=u.findIndex(t=>t===e),o=e+10,s=252*t,p=i()({},a,{transform:`translate3d(${s}px,${o}px,0)`,opacity:1,height:r});u[t]=o+r,c(p)}return p.a.createElement("div",{className:"waterfall-item",style:a},t)}t.default=class extends s.Component{constructor(e){super(e),a()(this,"state",{photos:[]}),a()(this,"handleUploaded",async e=>{const{directory:t,filename:n}=e,{status:r,message:i}=await function(e,t){return Object(d.a)({url:"/picture",method:"post",data:{directory:e,filename:t}})}(t,n);"success"===r?(l.message.success("上传成功"),this.getPictures()):l.message.error(i)}),a()(this,"getPictures",async()=>{const{status:e,message:t,data:n}=await Object(d.a)({url:"/picture"});"success"===e?this.setState({photos:n.map(e=>i()({},e,{width:244,height:0,visible:!1}))}):l.message.error(t)}),a()(this,"handleImgLoad",(e,t)=>{const n=[...this.state.photos],r=n[t];r&&(r.height=e.currentTarget.clientHeight+20,r.visible=!0),this.setState({photos:n})}),this.getPictures(),m=[],u=[-10,-10,-10,-10]}render(){const{photos:e}=this.state;return p.a.createElement("div",{className:g.a.className},p.a.createElement(A,null,p.a.createElement(x,{width:244,height:120,visible:!0},p.a.createElement(c.a,{bucketType:"user",onUploaded:this.handleUploaded},p.a.createElement("div",{className:"btn"},p.a.createElement(l.Icon,{type:"plus"}),p.a.createElement("span",null,"上传")))),e.map((e,t)=>{const{id:n,url:r,filename:i,width:o,height:a,visible:s}=e;return p.a.createElement(x,{key:n,width:o,height:a,visible:s},p.a.createElement("img",{src:r,alt:i,onLoad:e=>this.handleImgLoad(e,t)}))})))}}},45:function(e,t,n){var r=n(46);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(18)(r,i);r.locals&&(e.exports=r.locals)},46:function(e,t,n){(t=e.exports=n(17)(!1)).push([e.i,".ReactCrop {\n  position: relative;\n  display: inline-block;\n  cursor: crosshair;\n  overflow: hidden;\n  max-width: 100%;\n  background-color: #000; }\n  .ReactCrop:focus {\n    outline: none; }\n  .ReactCrop--disabled, .ReactCrop--locked {\n    cursor: inherit; }\n  .ReactCrop__image {\n    /* autoprefixer: off */\n    display: block;\n    max-width: 100%;\n    max-height: -webkit-fill-available;\n    max-height: -moz-available;\n    max-height: fill-available; }\n  .ReactCrop--crop-invisible .ReactCrop__image {\n    opacity: 0.5; }\n  .ReactCrop__crop-selection {\n    position: absolute;\n    top: 0;\n    left: 0;\n    -webkit-transform: translate3d(0, 0, 0);\n            transform: translate3d(0, 0, 0);\n    box-sizing: border-box;\n    cursor: move;\n    box-shadow: 0 0 0 9999em rgba(0, 0, 0, 0.5);\n    border: 1px solid;\n    border-image-source: url(\"data:image/gif;base64,R0lGODlhCgAKAJECAAAAAP///////wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI5RDc5MTFDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI5RDc5MTBDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQoAAgAsAAAAAAoACgAAAhWEERkn7W3ei7KlagMWF/dKgYeyGAUAIfkEBQoAAgAsAAAAAAoACgAAAg+UYwLJ7RnQm7QmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYgLJHdiinNSAVfOEKoUCACH5BAUKAAIALAAAAAAKAAoAAAIRVISAdusPo3RAzYtjaMIaUQAAIfkEBQoAAgAsAAAAAAoACgAAAg+MDiem7Q8bSLFaG5il6xQAIfkEBQoAAgAsAAAAAAoACgAAAg+UYRLJ7QnQm7SmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYBLJDdiinNSEVfOEKoECACH5BAUKAAIALAAAAAAKAAoAAAIRFISBdusPo3RBzYsjaMIaUQAAOw==\");\n    border-image-slice: 1;\n    border-image-repeat: repeat; }\n    .ReactCrop--disabled .ReactCrop__crop-selection {\n      cursor: inherit; }\n  .ReactCrop__drag-handle {\n    position: absolute;\n    width: 9px;\n    height: 9px;\n    background-color: rgba(0, 0, 0, 0.2);\n    border: 1px solid rgba(255, 255, 255, 0.7);\n    box-sizing: border-box;\n    outline: 1px solid transparent; }\n  .ReactCrop .ord-nw {\n    top: 0;\n    left: 0;\n    margin-top: -5px;\n    margin-left: -5px;\n    cursor: nw-resize; }\n  .ReactCrop .ord-n {\n    top: 0;\n    left: 50%;\n    margin-top: -5px;\n    margin-left: -5px;\n    cursor: n-resize; }\n  .ReactCrop .ord-ne {\n    top: 0;\n    right: 0;\n    margin-top: -5px;\n    margin-right: -5px;\n    cursor: ne-resize; }\n  .ReactCrop .ord-e {\n    top: 50%;\n    right: 0;\n    margin-top: -5px;\n    margin-right: -5px;\n    cursor: e-resize; }\n  .ReactCrop .ord-se {\n    bottom: 0;\n    right: 0;\n    margin-bottom: -5px;\n    margin-right: -5px;\n    cursor: se-resize; }\n  .ReactCrop .ord-s {\n    bottom: 0;\n    left: 50%;\n    margin-bottom: -5px;\n    margin-left: -5px;\n    cursor: s-resize; }\n  .ReactCrop .ord-sw {\n    bottom: 0;\n    left: 0;\n    margin-bottom: -5px;\n    margin-left: -5px;\n    cursor: sw-resize; }\n  .ReactCrop .ord-w {\n    top: 50%;\n    left: 0;\n    margin-top: -5px;\n    margin-left: -5px;\n    cursor: w-resize; }\n  .ReactCrop__disabled .ReactCrop__drag-handle {\n    cursor: inherit; }\n  .ReactCrop__drag-bar {\n    position: absolute; }\n    .ReactCrop__drag-bar.ord-n {\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 6px;\n      margin-top: -3px; }\n    .ReactCrop__drag-bar.ord-e {\n      right: 0;\n      top: 0;\n      width: 6px;\n      height: 100%;\n      margin-right: -3px; }\n    .ReactCrop__drag-bar.ord-s {\n      bottom: 0;\n      left: 0;\n      width: 100%;\n      height: 6px;\n      margin-bottom: -3px; }\n    .ReactCrop__drag-bar.ord-w {\n      top: 0;\n      left: 0;\n      width: 6px;\n      height: 100%;\n      margin-left: -3px; }\n  .ReactCrop--new-crop .ReactCrop__drag-bar,\n  .ReactCrop--new-crop .ReactCrop__drag-handle,\n  .ReactCrop--fixed-aspect .ReactCrop__drag-bar {\n    display: none; }\n  .ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-n,\n  .ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-e,\n  .ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-s,\n  .ReactCrop--fixed-aspect .ReactCrop__drag-handle.ord-w {\n    display: none; }\n  @media (max-width: 768px), (pointer: coarse) {\n    .ReactCrop__drag-handle {\n      width: 17px;\n      height: 17px; }\n    .ReactCrop .ord-nw {\n      margin-top: -9px;\n      margin-left: -9px; }\n    .ReactCrop .ord-n {\n      margin-top: -9px;\n      margin-left: -9px; }\n    .ReactCrop .ord-ne {\n      margin-top: -9px;\n      margin-right: -9px; }\n    .ReactCrop .ord-e {\n      margin-top: -9px;\n      margin-right: -9px; }\n    .ReactCrop .ord-se {\n      margin-bottom: -9px;\n      margin-right: -9px; }\n    .ReactCrop .ord-s {\n      margin-bottom: -9px;\n      margin-left: -9px; }\n    .ReactCrop .ord-sw {\n      margin-bottom: -9px;\n      margin-left: -9px; }\n    .ReactCrop .ord-w {\n      margin-top: -9px;\n      margin-left: -9px; }\n    .ReactCrop__drag-bar.ord-n {\n      height: 14px;\n      margin-top: -7px; }\n    .ReactCrop__drag-bar.ord-e {\n      width: 14px;\n      margin-right: -7px; }\n    .ReactCrop__drag-bar.ord-s {\n      height: 14px;\n      margin-bottom: -7px; }\n    .ReactCrop__drag-bar.ord-w {\n      width: 14px;\n      margin-left: -7px; } }\n\n.imageCropper-38CPD {\n  display: inline-block;\n  font-size: 0;\n  line-height: 0; }\n  .imageCropper-38CPD.active::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 9998;\n    background: rgba(255, 255, 255, 0.5); }\n  .imageCropper-38CPD .selector {\n    position: relative;\n    display: inline-block;\n    cursor: pointer; }\n    .imageCropper-38CPD .selector input {\n      position: absolute;\n      top: 0;\n      left: 0;\n      opacity: 0;\n      z-index: 1;\n      width: 100%;\n      height: 100%;\n      display: block;\n      cursor: pointer; }\n    .imageCropper-38CPD .selector .default-select {\n      width: 50px;\n      height: 50px;\n      border-radius: 3px;\n      border: 1px dashed #333333;\n      display: block;\n      position: relative;\n      cursor: pointer; }\n      .imageCropper-38CPD .selector .default-select::before {\n        content: '';\n        position: absolute;\n        width: 2px;\n        margin-left: -1px;\n        height: 50%;\n        background-color: #333333;\n        left: 50%;\n        top: 25%;\n        z-index: 0;\n        border-radius: 1px; }\n      .imageCropper-38CPD .selector .default-select::after {\n        content: '';\n        position: absolute;\n        height: 2px;\n        margin-top: -1px;\n        width: 50%;\n        background-color: #333333;\n        top: 50%;\n        left: 25%;\n        z-index: 0;\n        border-radius: 1px; }\n\n.crop-wrapper {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  box-shadow: 0px 5px 16px 0px rgba(0, 0, 0, 0.95);\n  z-index: 9999; }\n  .crop-wrapper .ReactCrop {\n    display: block; }\n  .crop-wrapper .tools {\n    position: absolute;\n    bottom: 10px;\n    right: 10px;\n    color: white; }\n    .crop-wrapper .tools button {\n      cursor: pointer;\n      border: 1px dashed #ccc;\n      margin: 0 3px;\n      font-size: 12px;\n      line-height: 20px; }\n",""]),t.locals={cropper:"imageCropper-38CPD"}},47:function(e,t,n){"use strict";var r=n(32),i=n.n(r),o=n(0),a=n.n(o),s=n(13),p=n.n(s),c=n(59),l=n.n(c),d=n(45),h=n.n(d);var g=class extends o.PureComponent{constructor(e){super(e),i()(this,"state",{originalSrc:"",crop:{x:0,y:0}}),i()(this,"originalFileName",""),i()(this,"image",void 0),i()(this,"pixelCrop",void 0),i()(this,"inputRef",a.a.createRef()),i()(this,"handleFileInput",e=>{const t=e.target.files&&e.target.files[0];if(!t)return;this.originalFileName=t.name;const n=new FileReader;n.readAsDataURL(t),n.onload=(()=>{this.setState({originalSrc:n.result})})}),i()(this,"handleCropChange",(e,t)=>{this.setState({crop:e}),this.pixelCrop=t}),i()(this,"handleImageloaded",(e,t)=>{this.image=e,this.pixelCrop=t}),i()(this,"getCroppedImg",(e,t,n)=>{const r=document.createElement("canvas");r.width=t.width,r.height=t.height;const i=r.getContext("2d");return i&&i.drawImage(e,t.x,t.y,t.width,t.height,0,0,t.width,t.height),new Promise((e,t)=>{r.toBlob(t=>{t.name=n,e(t)},"image/jpeg")})}),i()(this,"confirm",async()=>{const{onConfirm:e}=this.props;this.image&&this.pixelCrop&&e&&e(await this.getCroppedImg(this.image,this.pixelCrop,this.originalFileName)),this.cancel()}),i()(this,"cancel",()=>{this.setState({originalSrc:""}),this.inputRef.current&&(this.inputRef.current.value="")}),e.crop&&(this.state.crop=e.crop)}render(){const{originalSrc:e,crop:t}=this.state,{children:n}=this.props;let r;return e&&(r=a.a.createElement("div",{className:"crop-wrapper"},a.a.createElement(l.a,{src:e,crop:t,onImageLoaded:this.handleImageloaded,onChange:this.handleCropChange}),a.a.createElement("div",{className:"tools"},a.a.createElement("button",{type:"button",onClick:this.confirm},"确定"),a.a.createElement("button",{type:"button",onClick:this.cancel},"取消")))),a.a.createElement("div",{className:`${h.a.cropper} ${e?"active":""}`},a.a.createElement("div",{className:"selector"},n||a.a.createElement("span",{className:"default-select"}),a.a.createElement("input",{ref:this.inputRef,type:"file",onInput:this.handleFileInput,accept:"image/*"})),p.a.createPortal(r,document.body))}},m=n(60),u=n.n(m),A=n(35),x=n(10);t.a=class extends o.PureComponent{constructor(e){super(e),i()(this,"cos",void 0),i()(this,"file",void 0),i()(this,"credential",{TmpSecretId:"",TmpSecretKey:"",XCosSecurityToken:"",ExpiredTime:0}),i()(this,"region",""),i()(this,"bucket",""),i()(this,"directory",""),i()(this,"domain",""),i()(this,"upload",()=>{const{onUploaded:e,uploadDir:t,bucketType:n}=this.props;if("user"!==n&&!t)return console.warn("上传目录未指定");const r=this.directory||t,i=`${Date.now()}_${this.file.name}`;this.cos.putObject({Bucket:this.bucket,Region:this.region,Key:`${r}/${i}`,Body:this.file,onProgress(e){const{loaded:t,total:n,speed:r,percent:i}=e;console.log("percent ::",i)}},(t,n)=>{if(t)return console.log(t);const{Location:r}=n;e&&e({key:r,directory:this.directory,filename:i,domain:this.domain})})}),i()(this,"handleConfirm",e=>{this.file=e,this.upload()}),this.cos=new u.a({getAuthorization:async(e,t)=>{t(await this.getCredential())}}),this.getCredential()}async getCredential(){const{bucketType:e}=this.props;if(this.credential.ExpiredTime<Date.now()){const{status:t,message:n,data:r}=await Object(A.f)(e);return"success"===t?(this.credential={TmpSecretId:r.credentials&&r.credentials.tmpSecretId,TmpSecretKey:r.credentials&&r.credentials.tmpSecretKey,XCosSecurityToken:r.credentials&&r.credentials.sessionToken,ExpiredTime:1e3*r.expiredTime},this.region=r.region,this.bucket=r.bucket,this.directory=r.directory,this.domain=r.domain,this.credential):(x.message.error(n),{})}return this.credential}render(){const{children:e,crop:t}=this.props;return a.a.createElement(g,{onConfirm:this.handleConfirm,crop:t},e)}}},63:function(e,t,n){var r=n(32);e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){r(e,t,n[t])})}return e}}}]);